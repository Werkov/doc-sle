<?xml version="1.0" encoding="UTF-8"?>
<sect1 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="deployment_prep_zseries_prep_i.xml" version="5.0" xml:id="sec.zseries.prep">
 <title>Préparation de l'installation</title>

 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>oui</dm:translation>
  </dm:docmanager>
 </info>

 <para>
  Découvrez comment rendre les données accessibles pour l'installation, installer <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> selon différentes méthodes ainsi que préparer et utiliser l'IPL du système d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>. Vous trouverez également des informations sur la configuration et l'installation réseau.
 </para>

 <sect2 xml:id="sec.prep.makeavail">
  <title>Mise à disposition des données d'installation</title>
  <para>
   Cette section fournit des informations détaillées pour rendre accessibles les données d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> pour IBM z Systems. Selon l'ordinateur que vous utilisez et l'environnement système, choisissez une installation NFS ou FTP. Si vous exécutez des postes de travail Microsoft Windows dans votre environnement, vous pouvez utiliser le réseau Windows (y compris le protocole SMB) pour installer <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> sur votre système IBM z Systems.
  </para>
  <tip>
   <title>exécution d'un IPL à partir d'un DVD</title>
   <para>
    Depuis le Service Pack 1 de SUSE Linux Enterprise Server Version 10, il est possible d'exécuter un IPL depuis un DVD et d'utiliser ce dernier comme support d'installation. Cela peut s'avérer très pratique si vous êtes confronté à des restrictions concernant la configuration d'un serveur d'installation fournissant un support d'installation sur votre réseau. Vous devez disposer d'un lecteur de DVD SCSI associé à un protocole FCP.
   </para>
  </tip>
  <note>
   <title>aucune installation <quote>à partir du disque dur</quote></title>
   <para>
    Il est impossible de procéder à une installation depuis le disque dur en plaçant le contenu du DVD sur une partition sur un DASD.
   </para>
  </note>
  <sect3 xml:id="sec.prep.makeavail.linuxws">
   <title>Utilisation d'un poste de travail Linux ou d'un DVD <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase></title>
   <para>
    Si votre poste de travail Linux s'exécute dans votre environnement informatique, utilisez le poste de travail pour fournir les données d'installation au processus d'installation IBM z Systems via NFS ou FTP. Si le poste de travail Linux s'exécute sous <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>, vous pouvez configurer un serveur d'installation (NFS ou FTP) à l'aide du module YaST <guimenu>Serveur d'installation</guimenu>, comme décrit à la <xref linkend="sec.deployment.instserver.sles9"/>.
   </para>
   <sect4 xml:id="sec.prep.makeavail.linuxws.nfs">
    <title>Avec un serveur NFS</title>
    <para>
     Utilisez le serveur NFS (network file system - système de fichiers réseau) pour mettre à disposition le support d'installation.
    </para>
    <important>
     <title>exportation de périphériques installés avec NFS</title>
     <para>
      Exporter la racine du système de fichiers (<filename>/</filename>) n'entraîne pas l'exportation des périphériques installés, comme un DVD. Désignez explicitement le point d'installation dans <filename>/etc/exports</filename> :
     </para>
<screen>/media/dvd  *(ro)</screen>
     <para>
      Une fois ce fichier modifié, redémarrez le serveur NFS en exécutant la commande <command>sudo systemctl restart nfsserver</command>.
     </para>
    </important>
   </sect4>
   <sect4 xml:id="sec.prep.makeavail.linuxws.ftp">
    <title>Avec un serveur FTP</title>
    <para>
     La configuration d'un serveur FTP sur un système Linux implique d'installer et de configurer le logiciel serveur, tel que
     <package>vsftpd</package>. Si vous utilisez <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>, reportez-vous au <xref linkend="cha.ftp"/> pour obtenir des instructions d'installation. Le téléchargement des données d'installation via une connexion anonyme n'est pas pris en charge. Par conséquent, vous devez configurer le serveur FTP pour assurer l'authentification utilisateur.
    </para>
   </sect4>
   <sect4 xml:id="sec.prep.makeavail.linuxws.oncd">
    <title><phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> sur DVD</title>
    <para>
     Le DVD 1 de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> pour IBM z Systems contient une image Linux amorçable pour les postes de travail Intel et une image pour z Systems.
    </para>
    <para>
     Sur les postes de travail Intel, démarrez depuis ce DVD, répondez aux questions concernant la langue et la configuration du clavier, puis sélectionnez <guimenu>Démarrer le système de secours</guimenu>. Pour cette opération, 64 Mo minimum de mémoire vive sont requis. Aucun espace disque n'est requis, car tout le système de secours réside dans la mémoire vive du poste de travail. Cette approche nécessite que vous soyez familier avec Linux et la mise en réseau car vous devez configurer manuellement la mise en réseau du poste de travail.
    </para>
    <para>
     Pour z Systems, exécutez l'IPL de votre invité LPAR/VM depuis ce DVD, comme décrit à la <xref linkend="sec.prep.ipling.lpar.dvd"/>. Après avoir entré les paramètres de votre réseau, le système d'installation considère le DVD comme la source des données d'installation. Dans la mesure où z Systems ne peut pas être associé directement à un terminal compatible X11, choisissez entre une installation VNC ou SSH. SSH fournit également une installation graphique par le tunnelage de la connexion x via SSH grâce à <command>ssh -X</command>.
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec.prep.makeavail.windowsws">
   <title>Utilisation d'un poste travail Microsoft Windows</title>
   <para>
    Si un poste de travail Microsoft Windows est disponible sur votre réseau, utilisez cet ordinateur pour mettre à disposition le support d'installation. Pour ce faire, le moyen le plus simple est d'utiliser le protocole SMB, déjà inclus sur le système d'exploitation Windows. Assurez-vous de cocher la case <guimenu>SMB over TCP/IP (SMB sur TCP/IP)</guimenu> pour activer l'encapsulation de paquetages SMB dans les paquetages TCP/IP. Pour plus d'informations, reportez-vous à l'aide en ligne de Windows ou à la documentation Windows traitant de la mise en réseau. Vous pouvez également utiliser FTP. Un logiciel tiers pour Windows est également requis dans ce cas.
   </para>
   <sect4 xml:id="sec.prep.makeavail.windowsws.smb">
    <title>Avec un serveur SMB</title>
    <para>
     Pour mettre à disposition le support d'installation avec le serveur SMB, insérez le DVD 1 de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> dans le lecteur de DVD du poste de travail Windows. Créez ensuite un nouveau partage en utilisant la lettre du lecteur de DVD-ROM et mettez-le à disposition de toutes les personnes sur le réseau.
    </para>

    <para>
     Dans YaST, le chemin d'installation peut se présenter comme suit :
    </para>
<screen>smb://<replaceable>DOMAIN</replaceable>;<replaceable>USER</replaceable>:<replaceable>PW</replaceable>@<replaceable>SERVERNAME</replaceable>/<replaceable>SHAREPATH</replaceable></screen>
    <para>
     Où les marques de réservation ont la signification suivante :
    </para>
    <variablelist>
     <varlistentry>
      <term><replaceable>DOMAIN</replaceable>
      </term>
      <listitem>
       <para>
        Domaine de répertoire actif ou groupe de travail facultatif.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>USER</replaceable>
      </term>
      <term><replaceable>PW</replaceable>
      </term>
      <listitem>
       <para>
        Nom d'utilisateur et mot de passe facultatifs d'un utilisateur habilité à accéder à ce serveur et à son partage.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>SERVERNAME</replaceable>
      </term>
      <listitem>
       <para>
        Nom du serveur qui héberge le ou les partages.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>SHAREPATH</replaceable>
      </term>
      <listitem>
       <para>
        Chemin d'accès aux partages.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>


    <para/>

   </sect4>
   <sect4 xml:id="sec.prep.makeavail.windowsws.nfs">
    <title>Avec un serveur NFS</title>
    <para>
     Reportez-vous à la documentation fournie avec le produit tiers qui active les services du serveur NFS pour votre poste de travail Windows. Le lecteur contenant les DVD <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> doit se situer dans le chemin NFS disponible.
    </para>
   </sect4>
   <sect4 xml:id="sec.prep.makeavail.windowsws.ftp">
    <title>Avec un serveur FTP</title>
    <para>
     Reportez-vous à la documentation fournie avec le produit tiers qui active les services du serveur FTP sur votre poste de travail Windows. Le lecteur contenant les DVD <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> doit se situer dans le chemin FTP disponible.
    </para>
    <para>
     Le serveur FTP faisant partie de certaines versions de Microsoft Windows implémente uniquement un sous-ensemble des commandes FTP et n'est pas adapté pour fournir les données d'installation. Si c'est le cas de votre poste de travail Windows, utilisez un serveur FTP tiers offrant les fonctions requises.
    </para>
   </sect4>
   <sect4 xml:id="sec.prep.makeavail.windowsws.scsi">
    <title>Utilisation d'un lecteur de DVD SCSI associé à FCP</title>
    <para>
     Après avoir exécuté un IPL depuis le DVD SCSI, comme décrit à la <xref linkend="sec.info.iplopt.dvd"/>, le système d'installation utilise le DVD comme support d'installation. Dans ce cas, vous n'avez pas besoin des supports d'installation sur le serveur FTP, NFS ou SMB. Cependant, vous avez besoin des données de configuration réseau de votre <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>, car vous devez configurer le réseau au cours de l'installation afin d'effectuer une installation graphique au moyen de VNC ou X.
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec.prep.makeavail.zpxe_cobbler">
   <title>Utilisation d'un serveur Cobbler pour zPXE</title>
   <para>
    Pour effectuer un chargement IPL à partir du réseau, un serveur Cobbler est nécessaire afin de fournir le kernel, le fichier initrd et les données d'installation. La préparation du serveur Cobbler se décompose en quatre étapes :
   </para>
   <itemizedlist>
    <listitem>
     <para>
      Importation des données d'installation
     </para>
    </listitem>
    <listitem>
     <para>
      Ajout d'une distribution
     </para>
    </listitem>
    <listitem>
     <para>
      Ajout de profils
     </para>
    </listitem>
    <listitem>
     <para>
      Ajout de systèmes
     </para>
    </listitem>
   </itemizedlist>
   <sect4 xml:id="sec.prep.makeavail.zpxe_cobbler.import">
    <title>Importation des données d'installation</title>
    <para>
     L'importation du support exige que la source d'installation soit disponible sur le serveur Cobbler, à partir d'un DVD ou d'une source réseau. Exécutez la commande suivante pour importer les données :
    </para>
<screen>cobbler import --path=<replaceable>PATH</replaceable><co xml:id="cobbler.import.path"/> --name=<replaceable>IDENTIFIER</replaceable><co xml:id="cobbler.import.dirname"/> --arch=s390x</screen>
    <calloutlist>
     <callout arearefs="cobbler.import.path">
      <para>
       Point de montage des données d'installation.
      </para>
     </callout>
     <callout arearefs="cobbler.import.dirname">
      <para>
       Chaîne identifiant le produit importé ; <quote>sles12_s390x</quote>, par exemple. Cette chaîne est utilisée comme nom du sous-répertoire dans lequel sont copiées les données d'installation. Sur un serveur Cobbler qui s'exécute sous SUSE Linux Enterprise, il s'agit de <filename>/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable></filename>. Ce chemin peut être différent si le serveur Cobbler s'exécute sous un autre système d'exploitation.
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec.prep.makeavail.zpxe_cobbler.add_distro">
    <title>Ajout d'une distribution</title>
    <para>
     En ajoutant une distribution, vous indiquez au serveur Cobbler de fournir le kernel et le fichier initrd requis pour un chargement IPL via zPXE. Exécutez la commande suivante sur le serveur Cobbler afin d'ajouter <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> pour IBM z Systems :
    </para>
<screen>cobbler distro add --arch=s390 --breed=suse --name="<replaceable>IDENTIFIER</replaceable>"<co xml:id="cobbler.add.identifier"/> \
  --os-version=sles12<co xml:id="cobbler.add.os"/> \
  --initrd=/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/boot/s390x/initrd<co xml:id="cobbler.add.initrd"/> \
  --kernel=/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/boot/s390x/linux<co xml:id="cobbler.add.kernel"/> \
  --kopts="install=http://cobbler.example.com/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>"<co xml:id="cobbler.add.server"/>
    </screen>
    <calloutlist>
     <callout arearefs="cobbler.add.identifier">
      <para>
       Identificateur personnalisé pour la distribution, par exemple <quote>SLES <phrase role="productnumber"><phrase os="sles;sled;slerte">12 SP5</phrase></phrase> z Systems</quote>. Doit être unique.
      </para>
     </callout>
     <callout arearefs="cobbler.add.os">
      <para>
       Identificateur du système d'exploitation. Utilisez <literal>sles12</literal>.
      </para>
     </callout>
     <callout arearefs="cobbler.add.initrd">
      <para>
       Chemin d'accès au fichier initrd. La première partie du chemin d'accès (<filename>/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/</filename>) dépend de l'emplacement où Cobbler a importé les données et du nom du sous-répertoire choisi lors de l'importation des données d'installation.
      </para>
     </callout>
     <callout arearefs="cobbler.add.kernel">
      <para>
       Chemin d'accès au kernel. La première partie du chemin d'accès (<filename>/srv/www/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>/</filename>) dépend de l'emplacement où Cobbler a importé les données et du nom du sous-répertoire choisi lors de l'importation des données d'installation.
      </para>
     </callout>
     <callout arearefs="cobbler.add.server">
      <para>
       URl vers le répertoire d'installation sur le serveur Cobbler.
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec.prep.makeavail.zpxe_cobbler.profile">
    <title>Réglage du profil</title>
    <para>
     Lors de l'ajout d'une distribution (reportez-vous à la <xref linkend="sec.prep.makeavail.zpxe_cobbler.add_distro"/>), un profil correspondant à <replaceable>IDENTIFIER</replaceable> est généré automatiquement. Utilisez la commande suivante pour effectuer quelques adaptations nécessaires :
    </para>
<screen>cobbler distro edit \
--name=<replaceable>IDENTIFIER</replaceable><co xml:id="cobbler.profile.name"/> --os-version=sles10<co xml:id="cobbler.profile.os"/> --ksmeta=""<co xml:id="cobbler.profile.meta"/>
--kopts="install=http://cobbler.example.com/cobbler/ks_mirror/<replaceable>IDENTIFIER</replaceable>"<co xml:id="cobbler.profile.opts"/></screen>
    <calloutlist>
     <callout arearefs="cobbler.profile.name">
      <para>
       Identificateur du profil. Utilisez la même chaîne que celle spécifiée lorsque vous aviez ajouté la distribution.
      </para>
     </callout>
     <callout arearefs="cobbler.profile.os">
      <para>
       Version du système d'exploitation. Distribution à laquelle le profil doit être appliqué. Vous devez utiliser la chaîne spécifiée avec <option>--name=<replaceable>IDENTIFIER</replaceable></option> dans l'étape d'importation.
      </para>
     </callout>
     <callout arearefs="cobbler.profile.meta">
      <para>
       Option nécessaire pour la création des modèles des fichiers kickstart. Elle n'est pas utilisée pour SuSE, alors définissez une valeur vide comme spécifié dans l'exemple.
      </para>
     </callout>
     <callout arearefs="cobbler.profile.opts">
      <para>
       Liste des paramètres kernel séparés par des espaces. Doit inclure au moins le paramètre <literal>install</literal> comme illustré dans l'exemple.
      </para>
     </callout>
    </calloutlist>
   </sect4>
   <sect4 xml:id="sec.prep.makeavail.zpxe_cobbler.system">
    <title>Ajout de systèmes</title>
    <para>
     La dernière étape requise consiste à ajouter des systèmes au serveur Cobbler. L'ajout d'un système doit être effectué pour chaque invité z Systems qui doit démarrer via zPXE. Les invités sont identifiés au moyen de leur ID utilisateur z/VM (l'exemple suivant utilise l'ID <quote>linux01</quote>). Notez que cet ID doit être une chaîne en minuscules. Pour ajouter un système, exécutez la commande suivante :
    </para>
<screen>cobbler system add --name=linux01 --hostname=linux01.example.com \
--profile=<replaceable>IDENTIFIER</replaceable> --interface=qdio \
--ip-address=192.168.2.103 --subnet=192.168.2.255 --netmask=255.255.255.0 \
--name-servers=192.168.1.116 --name-servers-search=example.com \
--gateway=192.168.2.1 --kopts="<replaceable>KERNEL_OPTIONS</replaceable>"</screen>
    <para>
     L'option <option>--kopts</option> vous permet de spécifier les paramètres de kernel et d'installation que vous indiquez normalement dans le fichier parmfile. Les paramètres sont saisis dans une liste d'éléments séparés par des espaces sous la forme <replaceable>PARAMÈTRE1=VALEUR1 PARAMÈTRE2=VALEUR2</replaceable>. Le programme d'installation vous invite à saisir les paramètres manquants. Pour bénéficier d'une installation entièrement automatisée, vous devez indiquer tous les paramètres de mise en réseau, des DASD et un fichier AutoYaST. Vous trouverez, ci-dessous, un exemple d'invité équipé d'une interface OSA utilisant les mêmes paramètres réseau que ci-dessus.
    </para>
<screen>--kopts=" \
AutoYaST=http://192.168.0.5/autoinst.xml \
Hostname=linux01.example.com \
Domain=example.com \
HostIP=192.168.2.103 \
Gateway=192.168.2.1 \
Nameserver=192.168.1.116 \
Searchdns=example.com \
InstNetDev=osa; \
Netmask=255.255.255.0 \
Broadcast=192.168.2.255 \
OsaInterface=qdio \
Layer2=0 \
PortNo=0 \
ReadChannel=0.0.0700 \
WriteChannel=0.0.0701 \
DataChannel=0.0.0702 \
DASD=600"</screen>
   </sect4>
  </sect3>
  <sect3 xml:id="sec.prep.makeavail.dvd_usb_hmc">
   <title>Installation à partir d'un DVD ou d'un disque Flash de la console HMC</title>
   <para>
    Pour installer <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> (SLES) sur des serveurs IBM z Systems, une source d'installation réseau est généralement nécessaire. Toutefois, dans certains environnements, il peut parfois être impossible de remplir cette condition. Avec SUSE Linux Enterprise Server, vous pouvez utiliser le DVD existant ou le disque Flash de la console de gestion du matériel (HMC) comme source de l'installation sur une partition LPAR.
   </para>
   <para>
    Pour effectuer l'installation à partir du DVD ou du disque Flash de la console HMC, procédez comme suit :
   </para>
   <itemizedlist>
    <listitem>
     <para>
      Ajoutez
     </para>
     <para>
      <option>install=hmc:/</option>
     </para>
     <para>
      au fichier <filename>parmfile</filename> (voir <xref linkend="sec.appdendix.parm"/>) ou aux options de kernel.
     </para>
     <para/>
    </listitem>
    <listitem>
     <para>
      En mode manuel, vous pouvez également choisir dans <filename>linuxrc</filename> :
     </para>
     <para>
      <emphasis role="italic">Start Installation</emphasis> (Démarrer l'installation),
     </para>
     <para>
      <emphasis role="italic">Installation</emphasis>, puis
     </para>
     <para>
      <emphasis role="italic">Hardware Management Console</emphasis> (Console de gestion du matériel).
     </para>
     <para>
      Le support d'installation doit être inséré dans la console HMC.
     </para>
    </listitem>
   </itemizedlist>
   <important>
    <title>configuration du réseau</title>
    <para>
     N'oubliez pas de configurer le réseau dans <filename>linuxrc</filename> avant de procéder à l'installation. Il n'est pas possible de transmettre des paramètres de démarrage par la suite. De plus, il est très probable que vous ayez besoin d'un accès réseau. Dans <filename>linuxrc</filename>, accédez à<emphasis role="italic">Start Installation</emphasis> (Démarrer l'installation), puis sélectionnez <emphasis role="italic">Network Setup</emphasis> (Configuration du réseau).
    </para>
   </important>
   <important>
    <title>le système Linux doit d'abord démarrer</title>
    <para>
     Avant d'accorder l'accès au contenu sur le DVD ou le disque Flash de la console HMC, attendez que le système Linux démarre. L'exécution d'un IPL peut interrompre la connexion entre la console HMC et la partition LPAR. Si la première tentative d'utilisation de la méthode décrite échoue, vous pouvez accorder l'accès et réessayer l'option <option>HMC</option>.
    </para>
   </important>
   <note>
    <title>dépôt d'installation</title>
    <para>
     Étant donné la nature transitoire de l'assignation, les fichiers du disque Flash ou du DVD ne resteront pas en tant que dépôt pour l'installation. Si vous avez besoin d'un dépôt d'installation, enregistrez et utilisez le dépôt en ligne.
    </para>
   </note>
  </sect3>
 </sect2>

 <sect2 xml:id="sec.prep.inst_types">
  <title>Types d'installation</title>
  <para>
   Cette section traite des étapes à exécuter pour installer <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> pour tous les modes d'installation et de la méthode de recherche des informations appropriées. Une fois les étapes de préparation décrites dans les chapitres précédents effectuées, suivez la présentation du mode d'installation souhaité pour installer <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> sur votre système.
  </para>
  <para>
   Comme le décrit la <xref linkend="sec.prep.makeavail"/>, il existe trois modes différents d'installation pour Linux sur IBM z Systems :
  </para>
  <itemizedlist>
   <listitem>
    <para>
     Installation LPAR
    </para>
   </listitem>
   <listitem>
    <para>
     Installation z/VM
    </para>
   </listitem>
   <listitem>
    <para>
     Installation invité KVM
    </para>
   </listitem>
  </itemizedlist>
  <procedure xml:id="pro.prep.inst_types.lpar">
   <title>Présentation d'une installation LPAR</title>
   <step>
    <para>
     Préparez les périphériques requis pour l'installation. Reportez-vous à la <xref linkend="sec.prep.prep_ipl.natlpar"/>.
    </para>
   </step>
   <step>
    <para>
     Exécutez un IPL sur le système d'installation. Reportez-vous à la <xref linkend="sec.prep.ipling.lpar"/>.
    </para>
   </step>
   <step>
    <para>
     Configurez le réseau. Reportez-vous à la <xref linkend="sec.prep.netcfg"/>.
    </para>
   </step>
   <step>
    <para>
     Connectez-vous au système d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>. Reportez-vous à la <xref linkend="sec.prep.connect"/>.
    </para>
   </step>
   <step>
    <para>
     Lancez l'installation avec YaST et exécutez un IPL sur le système installé. Reportez-vous au <xref linkend="cha.inst"/>.
    </para>
   </step>
  </procedure>
  <procedure xml:id="pro.prep.inst_types.vm">
   <title>Présentation de l'installation z/VM</title>
   <step>
    <para>
     Préparez les périphériques requis pour l'installation. Reportez-vous à la <xref linkend="sec.prep.prep_ipl.vm"/>.
    </para>
   </step>
   <step>
    <para>
     Exécutez un IPL sur le système d'installation. Reportez-vous à la <xref linkend="sec.prep.ipling.vm"/>.
    </para>
   </step>
   <step>
    <para>
     Configurez le réseau. Reportez-vous à la <xref linkend="sec.prep.netcfg"/>.
    </para>
   </step>
   <step>
    <para>
     Connectez-vous au système d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>. Reportez-vous à la <xref linkend="sec.prep.connect"/>.
    </para>
   </step>
   <step>
    <para>
     Lancez l'installation avec YaST et exécutez un IPL sur le système installé. Reportez-vous au <xref linkend="cha.inst"/>.
    </para>
   </step>
  </procedure>
  <procedure xml:id="pro.prep.inst_types.kvm">
   <title>Présentation d'une installation invité KVM</title>
   <step>
    <para>
     Créez une image de disque virtuel et écrivez un fichier XML de domaine. Reportez-vous à la <xref linkend="sec.prep.prep_ipl.kvm"/>.
    </para>
   </step>
   <step>
    <para>
     Préparez la cible d'installation et exécutez un IPL sur l'invité de machine virtuelle. Reportez-vous à la <xref linkend="sec.prep.ipling.kvm"/>.
    </para>
   </step>
   <step>
    <para>
     <xref linkend="sec.prep.netcfg.data"/>.
    </para>
   </step>
   <step>
    <para>
     Connectez-vous au système d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>. Reportez-vous à la <xref linkend="sec.prep.connect"/>.
    </para>
   </step>
   <step>
    <para>
     Lancez l'installation avec YaST et exécutez un IPL sur le système installé. Reportez-vous au <xref linkend="cha.inst"/>.
    </para>
   </step>
  </procedure>
 </sect2>

 <sect2 xml:id="sec.prep.prep_ipl">
  <title>Préparation de l'IPL du système d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase></title>
  <para/>
  <sect3 xml:id="sec.prep.prep_ipl.natlpar">
   <title>Préparation de l'IPL d'une installation LPAR</title>
   <para>
    Configurez votre système IBM z Systems pour qu'il démarre en mode ESA/S390 ou Linux seul avec un profil d'activation approprié et IOCDS. Pour plus d'informations sur cette procédure, reportez-vous à la documentation IBM. Reportez-vous à la <xref linkend="sec.prep.ipling.lpar"/>.
   </para>
  </sect3>
  <sect3 xml:id="sec.prep.prep_ipl.vm">
   <title>Préparation de l'IPL d'une installation z/VM</title>
   <para/>
   <sect4 xml:id="sec.prep.prep_ipl.vm.linux_guest">
    <title>Ajout d'un invité Linux</title>
    <para>
     Pour commencer, connectez et formatez un ou plusieurs DASD sur le système que l'invité Linux doit utiliser dans z/VM. Créez ensuite un nouvel utilisateur dans z/VM. Cet exemple illustre le répertoire pour un utilisateur <literal>LINUX1</literal> avec le mot de passe <literal>LINPWD</literal>, une mémoire de 1 Go (pouvant atteindre 2 Go), une mémoire vive étendue de 32 Mo (XSTORE), plusieurs minidisques (MDISK), deux unités centrales et un périphérique OSA QDIO.
    </para>
    <tip>
     <title>affectation de mémoire aux invités z/VM</title>
     <para>
      Lorsque vous affectez de la mémoire à un invité z/VM, assurez-vous que la taille de la mémoire est adaptée aux besoins de votre type d'installation préférée. Reportez-vous à la <xref linkend="sec.info_sysreq.sysreq.hw.mem"/>. Pour définir la taille de la mémoire sur 1 Go, utilisez la commande <command>CP DEFINE STORAGE 1G</command>. À la fin de l'installation, réinitialisez la taille de la mémoire vers la valeur souhaitée.
     </para>
    </tip>
    <example xml:id="ex.prep.prep_ipl.vm.linux_guest.config">
     <title>Configuration d'un répertoire z/VM</title>
<screen>USER LINUX1 LINPWD 1024M 2048M G
*____________________________________________
* LINUX1
*____________________________________________
* This VM Linux guest has two CPUs defined.

CPU 01 CPUID 111111
CPU 02 CPUID 111222
IPL CMS PARM AUTOCR
IUCV ANY
IUCV ALLOW
MACH ESA 10
OPTION MAINTCCW RMCHINFO
SHARE RELATIVE 2000
CONSOLE 01C0 3270 A
SPOOL 000C 2540 READER *
SPOOL 000D 2540 PUNCH A
SPOOL 000E 3203 A
* OSA QDIO DEVICE DEFINITIONS
DEDICATE 9A0 9A0
DEDICATE 9A1 9A1
DEDICATE 9A2 9A2
*
LINK MAINT 0190 0190 RR
LINK MAINT 019E 019E RR
LINK MAINT 019D 019D RR
* MINIDISK DEFINITIONS
MDISK 201 3390 0001 0050 DASD40 MR ONE4ME TWO4ME THR4ME
MDISK 150 3390 0052 0200 DASD40 MR ONE4ME TWO4ME THR4ME
MDISK 151 3390 0253 2800 DASD40 MR ONE4ME TWO4ME THR4ME</screen>
    </example>
    <para>
     Cet exemple utilise un minidisque 201 comme disque d'un invité. Le minidisque 150 avec 200 cylindres est le périphérique de commutation Linux. Le disque 151 avec 2 800 cylindres contient l'installation Linux.
    </para>
    <para>
     A ce stade, ajoutez (en tant qu'utilisateur <systemitem class="username">MAINT</systemitem>) l'invité au répertoire utilisateur avec la commande <command>DIRM FOR LINUX1 ADD</command>. Saisissez le nom de l'invité (<literal>LINUX1</literal>) et appuyez sur la touche <keycap>F5</keycap>. Configurez l'environnement de l'utilisateur avec :
    </para>
<screen>DIRM DIRECT
DIRM USER WITHPASS</screen>
    <para>
     La dernière commande renvoie un numéro de fichier du lecteur. Ce numéro est requis pour exécuter la commande suivante :
    </para>
<screen>RECEIVE &lt;number&gt; USER DIRECT A (REPL)</screen>
    <para>
     Vous pouvez désormais vous connecter sur Invité en tant qu'utilisateur <systemitem class="username">Linux1</systemitem>.
    </para>
    <para>
     Si l'option <literal>dirmaint</literal> n'est pas disponible, reportez-vous à la documentation IBM pour configurer cet utilisateur.
    </para>
    <para>
     Reportez-vous à la <xref linkend="sec.prep.ipling.vm"/>.
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec.prep.prep_ipl.kvm">
   <title>Préparation de l'IPL d'une installation invité KVM</title>
   <para>
    Une installation d'invité KVM nécessite un fichier XML de domaine définissant la machine virtuelle et au moins une image de disque virtuel pour l'installation.
   </para>
   <sect4 xml:id="sec.prep.prep_ipl.kvm.disk">
    <title>Création d'une image de disque virtuel</title>
    <para>
     Par défaut, libvirt recherche des images de disque dans le dossier <filename>/var/lib/libvirt/images/</filename> sur le serveur hôte de machine virtuelle. Bien que les images puissent aussi être stockées n'importe où ailleurs sur le système de fichiers, il est recommandé de les enregistrer toutes à un emplacement unique pour faciliter leur maintenance. L'exemple suivant crée une image qcow2 avec une taille de 10 Go dans le dossier <filename>/var/lib/libvirt/images/</filename>. Pour plus d'informations, reportez-vous au <xref linkend="cha.qemu.guest_inst.qemu-img"/>.
    </para>
    <procedure>
     <step>
      <para>
       Connectez-vous au serveur hôte KVM.
      </para>
     </step>
     <step>
      <para>
       Exécutez la commande suivante pour créer l'image :
      </para>
<screen>qemu-img create -f qcow2 /var/lib/libvirt/images/s12lin_qcow2.img 10G</screen>
     </step>
    </procedure>
   </sect4>
   <sect4 xml:id="sec.prep.prep_ipl.kvm.domain">
    <title>Écriture d'un fichier XML de domaine</title>
    <para>
     Un fichier XML de domaine est utilisé pour définir l'invité de machine virtuelle. Pour créer le fichier XML de domaine, ouvrez un fichier vide <filename>s12-1.xml</filename> dans un éditeur et créez un fichier comme dans l'exemple suivant.
    </para>
    <example>
     <title>Exemple de fichier XML de domaine</title>
     <para>
      L'exemple suivant crée un invité de machine virtuelle avec un seul processeur, 1 Go de RAM et l'image de disque virtuel créée à la section précédente (<xref linkend="sec.prep.prep_ipl.kvm.disk"/>). Il part du principe que l'interface réseau hôte à laquelle est associé le serveur virtuel est <literal>bond0</literal>. Modifiez l'élément de périphériques source pour qu'il corresponde à votre configuration réseau.
     </para>
<screen>&lt;domain type="kvm"&gt;
 &lt;name&gt;s12-1&lt;/name&gt;
 &lt;description&gt;Guest-System SUSE Sles12&lt;/description&gt;
 &lt;memory&gt;1048576&lt;/memory&gt;
 &lt;vcpu&gt;1&lt;/vcpu&gt;
 &lt;os&gt;
  &lt;type arch="s390x" machine="s390-ccw-virtio"&gt;hvm&lt;/type&gt;
  &lt;!-- Boot kernel - remove 3 lines after successfull installation --&gt;
  &lt;kernel&gt;/var/lib/libvirt/images/s12-kernel.boot&lt;/kernel&gt;
  &lt;initrd&gt;/var/lib/libvirt/images/s12-initrd.boot&lt;/initrd&gt;
  &lt;cmdline&gt;linuxrcstderr=/dev/console&lt;/cmdline&gt;
 &lt;/os&gt;
 &lt;iothreads&gt;1&lt;/iothreads&gt;
 &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
 &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
 &lt;on_crash&gt;preserve&lt;/on_crash&gt;
 &lt;devices&gt;
  &lt;emulator&gt;/usr/bin/qemu-system-s390x&lt;/emulator&gt;
  &lt;disk type="file" device="disk"&gt;
   &lt;driver name="qemu" type="qcow2" cache="none" iothread="1" io="native"/&gt;
   &lt;source file="/var/lib/libvirt/images/s12lin_qcow2.img"/&gt;
   &lt;target dev="vda" bus="virtio"/&gt;
  &lt;/disk&gt;
  &lt;interface type="direct"&gt;
   &lt;source dev="bond0" mode="bridge"/&gt;
   &lt;model type="virtio"/&gt;
  &lt;/interface&gt;
  &lt;console type="pty"&gt;
   &lt;target type="sclp"/&gt;
  &lt;/console&gt;
 &lt;/devices&gt;
&lt;/domain&gt;</screen>
    </example>
   </sect4>
  </sect3>
 </sect2>

 <sect2 xml:id="sec.prep.ipling">
  <title>Exécution d'un IPL sur le système d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase></title>
  <para/>
  <sect3 xml:id="sec.prep.ipling.lpar">
   <title>Exécution d'un IPL sur une installation LPAR</title>
   <para>
    Il existe différentes façons d'exécuter un IPL sur <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> au sein d'une partition LPAR. La méthode recommandée est d'utiliser la fonction <guimenu>Load from CD-ROM or server (Charger depuis un CD-ROM ou un serveur)</guimenu> de SE ou HMC.
   </para>
   <sect4 xml:id="sec.prep.ipling.lpar.cdrom">
    <title>Exécution d'un IPL à partir d'un DVD-ROM</title>
    <para>
     Cochez le LPAR à installer, puis sélectionnez <guimenu>Load from CD-ROM or server (Charger depuis un CD-ROM ou un serveur)</guimenu>. Ne remplissez pas le champ relatif à l'emplacement du fichier ou saisissez le chemin d'accès au répertoire racine du premier DVD-ROM, puis sélectionnez Continuer. Dans la liste des options qui s'affiche, sélectionnez l'emplacement par défaut. <guimenu>Operating system messages (Messages du système d'exploitation)</guimenu> doit afficher les messages de démarrage du kernel.
    </para>
   </sect4>
   <sect4 xml:id="sec.prep.ipling.lpar.dvd">
    <title>Exécution d'un IPL à partir d'un DVD SCSI associé FCP</title>
    <para>
     Vous pouvez utiliser la procédure <guimenu>LOAD</guimenu> en sélectionnant <guimenu>SCSI</guimenu> comme <guimenu>Type de chargement</guimenu> pour exécuter un IPL à partir de SCSI. Entrez le WWPN (Worldwide port name, Identifiant unique de port) et le LUN (Logical unit number, Identifiant d'unité logique) fournis par votre pont ou stockage SCSI (16 chiffres ; ne pas oublier les 0 à droite). Le sélecteur du programme de démarrage doit être réglé sur 2. Utilisez votre adaptateur FCP comme <guimenu>Adresse de chargement</guimenu> et exécutez un IPL.
    </para>
   </sect4>
  </sect3>
  <sect3 xml:id="sec.prep.ipling.vm">
   <title>Exécution d'un IPL sur une installation z/VM</title>
   <para>
    Cette section traite de l'exécution d'un IPL sur le système d'installation afin d'installer <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> pour IBM z Systems sur un système z/VM.
   </para>
   <sect4 xml:id="sec.prep.ipling.vm.reader">
    <title>Exécution d'un IPL à partir du lecteur z/VM</title>
    <para>
     Vous avez besoin d'une bonne connexion TCP/IP et d'un programme client FTP dans votre invité z/VM récemment défini pour transférer le système d'installation via FTP. La configuration de TCP/IP pour z/VM ne sera pas abordée dans ce manuel. À ce propos, reportez-vous à la documentation IBM appropriée.
    </para>
    <para>
     Connectez-vous en tant qu'invité Linux z/VM pour exécuter un IPL. Rendez le contenu du répertoire <filename>/boot/s390x</filename> du DVD 1 de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> pour IBM z Systems accessible via FTP sur votre réseau. Récupérez les fichiers <filename>linux</filename>, <filename>initrd</filename>, <filename>parmfile</filename> et <filename>sles12.exec</filename> dans ce répertoire. Transférez les fichiers avec une taille de blocs fixe de 80 caractères. Spécifiez la taille en exécutant la commande FTP <command>locsite fix 80</command>. Il est important de copier les fichiers <filename>linux</filename> (kernel Linux) et <filename>initrd</filename> (image d'installation) comme fichiers binaires. Pour ce faire, utilisez le mode de transfert <literal>binary</literal>. Les fichiers <filename>parmfile</filename> et <filename>sles12.exec</filename> doivent être transférés en mode ASCII.
    </para>
    <para>
     L'exemple montre les étapes requises. Dans cet exemple, les fichiers requis sont accessibles sur un serveur FTP à l'adresse IP <literal>192.168.0.3</literal>, avec l'ID de connexion <systemitem class="username">lininst</systemitem>. Ces informations peuvent varier selon le réseau.
    </para>
    <example xml:id="ex.prep.ipling.vm.reader.ftp.ftptrans">
     <title>Transfert de fichiers binaires via le serveur FTP</title>
<screen>FTP 192.168.0.3
VM TCP/IP FTP Level 530
Connecting to 192.168.0.3, port 21
220 ftpserver FTP server (Version wu-2.4.2-academ[BETA-18](1)
Thu Feb 11 16:09:02 GMT 2010) ready.
USER
lininst
331 Password required for lininst
PASS
******
230 User lininst logged in.
Command:
binary
200 Type set to I
Command:
locsite fix 80
Command:
get /media/dvd1/boot/s390x/linux sles12.linux
200 PORT Command successful
150 Opening BINARY mode data connection for /media/dvd1/boot/s390x/linux
(10664192 bytes)
226 Transfer complete.
10664192 bytes transferred in 13.91 seconds.
Transfer rate 766.70 Kbytes/sec.
Command:
get /media/dvd1/boot/s390x/initrd sles12.initrd
200 PORT Command successful
150 Opening BINARY mode data connection for /media/dvd1/boot/s390x/initrd
(21403276 bytes)
226 Transfer complete.
21403276 bytes transferred in 27.916 seconds.
Transfer rate 766.70 Kbytes/sec.
Command:
ascii
200 Type set to A
Command:
get /media/dvd1/boot/s390x/parmfile sles12.parmfile
150 Opening ASCII mode data connection for /media/dvd1/boot/s390x/parmfile
(5 bytes)
226 Transfer complete.
5 bytes transferred in 0.092 seconds.
Transfer rate 0.05 Kbytes/sec.
Command:
get /media/dvd1/boot/s390x/sles12.exec sles12.exec
150 Opening ASCII mode data connection for /media/dvd1/boot/s390x/sles12.exec
(891 bytes)
226 Transfer complete.
891 bytes transferred in 0.097 seconds.
Transfer rate 0.89 Kbytes/sec.
Command:
quit</screen>
    </example>
    <para>
     Utilisez le fichier sles12.exec de script REXX que vous avez téléchargé pour exécuter un IPL sur le système d'installation Linux. Ce script charge le kernel, le fichier parmfile et le disque virtuel initial dans le lecteur pour exécuter un IPL.
    </para>
    <example xml:id="sex.prep.ipling.vm.reader.startscript.slesexec">
     <title>SLES12 EXEC</title>
<screen>/* REXX LOAD EXEC FOR SUSE LINUX S/390 VM GUESTS       */
/* LOADS SUSE LINUX S/390 FILES INTO READER            */
SAY ''
SAY 'LOADING SLES12 FILES INTO READER...'
'CP CLOSE RDR'
'PURGE RDR ALL'
'SPOOL PUNCH * RDR'
'PUNCH SLES12 LINUX A (NOH'
'PUNCH SLES12 PARMFILE A (NOH'
'PUNCH SLES12 INITRD A (NOH'
'IPL 00C'</screen>
    </example>
    <para>
     Ce script permet d'exécuter un IPL sur le système d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> avec la commande <command>sles12</command>. Le kernel Linux démarre et imprime ses messages de démarrage.
    </para>
    <para>
     Pour continuer l'installation, passez à la <xref linkend="sec.prep.netcfg"/>.
    </para>
   </sect4>
   <sect4 xml:id="sec.prep.ipling.vm.dvd">
    <title>Exécution d'un IPL à partir d'un DVD SCSI associé FCP</title>
    <para>
     Pour exécuter un IPL dans z/VM, préparez le processus IPL de SCSI en utilisant le paramètre SET LOADDEV :
    </para>
<screen>SET LOADDEV PORTNAME 200400E8 00D74E00 LUN 00020000 00000000 BOOT 2</screen>
    <para>
     Une fois le paramètre LOADDEV configuré avec les valeurs appropriées, exécutez un IPL sur votre adaptateur FCP, par exemple :
    </para>
<screen>IPL FC00</screen>
    <para>
     Pour continuer l'installation, passez à la <xref linkend="sec.prep.netcfg"/>.
    </para>
   </sect4>
   <sect4 xml:id="sec.prep.ipling.vm.zpxe">
    <title>IPL à partir d'un serveur Cobbler avec zPXE</title>
    <para>
     Pour exécuter un IPL à partir d'un serveur Cobbler avec zPXE, vous devez transférer le script <filename>zpxe.rexx</filename> via FTP du serveur Cobbler vers votre invité z/VM. L'invité z/VM a besoin d'une connexion TCP/IP opérationnelle et d'un programme client FTP.
    </para>
    <para>
     Connectez-vous en tant qu'invité z/VM Linux pour effectuer un chargement IPL et transférer le script avec une taille fixe de 80 caractères en mode ASCII (voir <xref linkend="ex.prep.ipling.vm.reader.ftp.ftptrans"/>, par exemple). Le script <filename>zpxe.rexx</filename> est disponible sur le serveur Cobbler à l'emplacement <filename>/usr/share/doc/packages/S390-Tools /</filename>.
    </para>
    <para>
     <filename>zpxe.rexx</filename> est censé remplacer le fichier <filename>PROFILE EXEC</filename> de votre invité. Effectuez une copie de sauvegarde du fichier <filename>PROFILE EXEC</filename> et renommez <filename>ZPXE REXX</filename> en <filename>PROFILE EXEC</filename>. Une autre solution consiste à appeler <filename>ZPXE REXX</filename> à partir du fichier <filename>PROFILE EXEC</filename> existant en ajoutant une nouvelle ligne avec le contenu suivant : <literal>'ZPXE REXX'</literal>.
    </para>
    <para>
     La dernière étape consiste à créer un fichier de configuration, <filename>ZPXE CONF</filename>, en indiquant à <filename>ZPXE REXX</filename> le serveur Cobbler à contacter et le disque à charger par IPL. Exécutez <command>xedit zpxe conf a</command> et créez <filename>ZPXE CONF</filename> avec le contenu suivant (remplacez les données d'exemple en conséquence) :
    </para>
<screen>HOST cobbler.example.com
IPLDISK 600</screen>
    <para>
     Le serveur Cobbler sera connecté lors de la prochaine connexion à votre invité z/VM. Si une installation est programmée sur le serveur Cobbler, elle est exécutée. Pour programmer l'installation, exécutez la commande suivante sur le serveur Cobbler :
    </para>
<screen>cobbler system edit --name <replaceable>ID</replaceable><co xml:id="cobbler.sysedit.id"/> --netboot-enabled 1<co xml:id="cobbler.sysedit.netboot"/> --profile <replaceable>PROFILENAME</replaceable><co xml:id="cobbler.sysedit.profile"/></screen>
    <calloutlist>
     <callout arearefs="cobbler.sysedit.id">
      <para>
       ID utilisateur z/VM.
      </para>
     </callout>
     <callout arearefs="cobbler.sysedit.netboot">
      <para>
       Activez le chargement IPL à partir du réseau.
      </para>
     </callout>
     <callout arearefs="cobbler.sysedit.profile">
      <para>
       Nom du profil existant, voir <xref linkend="sec.prep.makeavail.zpxe_cobbler.profile"/>.
      </para>
     </callout>
    </calloutlist>
   </sect4>
  </sect3>
  <sect3 xml:id="sec.prep.ipling.kvm">
   <title>Exécution d'un IPL sur une installation invité KVM</title>
   <para>
    Pour démarrer l'installation de l'invité, vous devez tout d'abord démarrer l'invité de machine virtuelle défini à la <xref linkend="sec.prep.prep_ipl.kvm.disk"/>. Pour ce faire, vous devez commencer par rendre disponibles les fichiers kernel et initrd requis pour exécuter l'IPL.
   </para>
   <sect4 xml:id="sec.prep.ipling.kvm.prep">
    <title>Préparation de la source d'installation</title>
    <para>
     Le kernel et l'image initrd du système d'installation doivent être copiés sur le serveur hôte de machine virtuelle pour permettre l'exécution d'un IPL sur l'invité de machine virtuelle sur le système d'installation.
    </para>
    <procedure>
     <step>
      <para>
       Connectez-vous à l'hôte KVM et assurez-vous que vous pouvez vous connecter à l'hôte distant ou au périphérique qui fournit la source d'installation.
      </para>
     </step>
     <step>
      <para>
       Copiez les deux fichiers suivants de la source d'installation vers l'emplacement <filename>/var/lib/libvirt/images/</filename>. Si les données sont fournies à partir d'un hôte distant, utilisez <command>ftp</command>, <command>sftp</command> ou <command>scp</command> pour transférer les fichiers :
      </para>
      <simplelist>
       <member><filename>/boot/s390x/initrd</filename>
       </member>
       <member><filename>/boot/s390x/cd.ikr</filename>
       </member>
      </simplelist>
     </step>
     <step>
      <para>
       Renommez les fichiers sur l'hôte KVM :
      </para>
<screen>cd /var/lib/libvirt/images/
mv initrd s12-initrd.boot
 mv cd.ikr s12-kernel.boot</screen>
     </step>
    </procedure>
   </sect4>
   <sect4 xml:id="sec.prep.ipling.kvm.">
    <title>Exécution d'un IPL sur l'invité de machine virtuelle</title>
    <para>
     Pour exécuter un IPL sur l'invité de machine virtuelle, connectez-vous à l'hôte KVM et exécutez la commande suivante :
    </para>
<screen>virsh  create s12-1.xml --console</screen>
    <para>
     Une fois le démarrage de l'invité de machine virtuelle effectué, le système d'installation démarre et le message suivant s'affiche :
    </para>
<screen>Domain s12-1 started
Connected to domain s12-1
Escape character is ^]
Initializing cgroup subsys cpuset
Initializing cgroup subsys cpu
Initializing
cgroup subsys cpuacct
.
.
Please make sure your installation medium is available.
Retry?
0) &lt;-- Back &lt;--
1) Yes
2) No</screen>
    <para>
     Répondez <guimenu>2) No</guimenu> (Non) et choisissez <guimenu>Installation</guimenu> à l'étape suivante. Procédez comme décrit à la <xref linkend="sec.prep.netcfg.data"/>.
    </para>
   </sect4>
  </sect3>
 </sect2>

 <sect2 xml:id="sec.prep.netcfg">
  <title>Configuration réseau</title>
  <para>
   Patientez jusqu'à ce que le kernel ait terminé ses routines de démarrage. Si vous effectuez une installation en mode basique ou dans un LPAR, ouvrez le menu <guimenu>Operating System Messages (Messages du système d'exploitation)</guimenu> sur HMC ou SE.
  </para>
  <para>
   Pour commencer, choisissez <guimenu>Démarrer l'installation</guimenu> dans le menu principal linuxrc, puis <guimenu>Démarrer l'installation ou la mise à jour</guimenu> pour lancer le processus d'installation. Sélectionnez <guimenu>Réseau</guimenu> comme support d'installation, puis sélectionnez le type de protocole réseau qui sera utilisé pour l'installation. La <xref linkend="sec.prep.makeavail"/> décrit comment mettre à disposition les données d'installation pour différents types de connexions réseau. Actuellement, <guimenu>FTP</guimenu>, <guimenu>HTTP</guimenu>, <guimenu>NFS</guimenu> et <guimenu>SMB/CIFS</guimenu> (partage de fichiers Windows) sont pris en charge.
  </para>
  <para>
   Sélectionnez, dans la liste des périphériques disponibles, un périphérique réseau OSA ou HiperSockets sur lequel consigner les données d'installation. Il se peut que cette liste contienne également des périphériques CTC, ESCON ou IUCV, mais ces derniers ne sont plus pris en charge sur <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>.
  </para>
  <sect3 xml:id="sec.prep.netcfg.hypersockets">
   <title>Configuration d'une interface HiperSockets</title>
   <para>
    Sélectionnez un périphérique HiperSockets dans la liste des périphériques réseau. Saisissez ensuite les numéros des canaux de lecture, d'écriture et de données :
   </para>
   <example xml:id="ex.appdendix.inst_netcontypes.types">
    <title>Types de connexion réseau pris en charge et paramètres des pilotes</title>
<screen>Choose the network device.

 1) IBM parallel CTC Adapter (0.0.0600)
 2) IBM parallel CTC Adapter (0.0.0601)
 3) IBM parallel CTC Adapter (0.0.0602)
 4) IBM Hipersocket (0.0.0800)
 5) IBM Hipersocket (0.0.0801)
 6) IBM Hipersocket (0.0.0802)
 7) IBM OSA Express Network card (0.0.0700)
 8) IBM OSA Express Network card (0.0.0701)
 9) IBM OSA Express Network card (0.0.0702)
10) IBM OSA Express Network card (0.0.f400)
11) IBM OSA Express Network card (0.0.f401)
12) IBM OSA Express Network card (0.0.f402)
13) IBM IUCV

&gt; 4

Device address for read channel. (Enter '+++' to abort).
[0.0.800]&gt; 0.0.800

Device address for write channel. (Enter '+++' to abort).
[0.0.801]&gt; 0.0.801

Device address for data channel. (Enter '+++' to abort).
[0.0.802]&gt; 0.0.802</screen>
   </example>
  </sect3>
  <sect3 xml:id="sec.prep.netcfg.osa">
   <title>Configuration d'un périphérique OSA Express</title>
   <para>
    Sélectionnez un périphérique OSA Express dans la liste des périphériques réseau, puis indiquez un numéro de port. Saisissez ensuite les numéros des canaux de lecture, d'écriture et de données, ainsi que le nom du port, le cas échéant. Choisissez si vous souhaitez activer la prise en charge de la couche OSI de niveau 2.
   </para>
   <para>
    Le numéro de port a été ajouté pour permettre la prise en charge des nouveaux périphériques réseau OSA Express 3 à 2 ports. Si vous n'utilisez pas de périphérique OSA Express 3, veuillez saisir <literal>0</literal>. Les cartes OSA Express peuvent aussi s'exécuter dans un mode de <quote>prise en charge de la couche OSI de niveau 2</quote> ou utiliser un mode commun plus ancien <quote>couche de niveau 3</quote>. Le mode de la carte affecte tous les systèmes qui partagent le périphérique, y compris les systèmes sur d'autres LPAR. Si vous avez un doute, indiquez <literal>2</literal> pour assurer une compatibilité avec le mode par défaut utilisé par les autres systèmes d'exploitation, comme z/VM et z/OS. Consultez votre administrateur de matériel pour obtenir plus d'informations sur ces options.
   </para>
   <example xml:id="ex.appdendix.inst_netcontypes.gigabit.param">
    <title>Paramètres du pilote de périphérique réseau</title>
<screen>Choose the network device.

 1) IBM parallel CTC Adapter (0.0.0600)
 2) IBM parallel CTC Adapter (0.0.0601)
 3) IBM parallel CTC Adapter (0.0.0602)
 4) IBM Hipersocket (0.0.0800)
 5) IBM Hipersocket (0.0.0801)
 6) IBM Hipersocket (0.0.0802)
 7) IBM OSA Express Network card (0.0.0700)
 8) IBM OSA Express Network card (0.0.0701)
 9) IBM OSA Express Network card (0.0.0702)
10) IBM OSA Express Network card (0.0.f400)
11) IBM OSA Express Network card (0.0.f401)
12) IBM OSA Express Network card (0.0.f402)
13) IBM IUCV

&gt; 7

Enter the relative port number. (Enter '+++' to abort).
&gt; 0

Device address for read channel. (Enter '+++' to abort).
[0.0.0700]&gt; 0.0.0700

Device address for write channel. (Enter '+++' to abort).
[0.0.0701]&gt; 0.0.0701

Device address for data channel. (Enter '+++' to abort).
[0.0.0702]&gt; 0.0.0702

Enable OSI Layer 2 support?

0) &lt;-- Back &lt;--
1) Yes
2) No

&gt; 1

MAC address. (Enter '+++' to abort).
&gt; +++</screen>
   </example>
  </sect3>
  <sect3 xml:id="sec.prep.netcfg.data">
   <title>Configuration du réseau et sélection de la source d'installation</title>
   <para>
    Après avoir saisi tous les paramètres de périphérique réseau, le pilote approprié est installé et les messages de kernel correspondants sont affichés.
   </para>
   <para>
    Ensuite, choisissez d'utiliser ou non la configuration automatique DHCP pour configurer les paramètres de l'interface réseau. Etant donné que DHCP fonctionne uniquement sur quelques périphériques et qu'il requiert des paramètres de configuration matérielle spécifiques, il est préférable de cliquer sur <guimenu>NO (Non)</guimenu> à cet endroit. Dans ce cas, vous êtes invité à indiquer les paramètres suivants :
   </para>
   <itemizedlist>
    <listitem>
     <para>
      L'adresse IP du système à installer
     </para>
    </listitem>
    <listitem>
     <para>
      Le masque de réseau correspondant (s'il n'a pas été spécifié avec l'adresse IP).
     </para>
    </listitem>
    <listitem>
     <para>
      L'adresse IP d'une passerelle pour accéder au serveur
     </para>
    </listitem>
    <listitem>
     <para>
      La liste des domaines de recherche couverts par le serveur DNS
     </para>
    </listitem>
    <listitem>
     <para>
      L'adresse IP du serveur de noms de domaine
     </para>
    </listitem>
   </itemizedlist>
   <example xml:id="ex.prep.netcfg.vm.network_setup">
    <title>Paramètres réseau</title>
<screen>Automatic configuration via DHCP?

0) &lt;-- Back &lt;--
1) Yes
2) No

&gt; 2

Enter your IP address with network prefix.

You can enter more than one, separated by space, if necessary.
Leave empty for autoconfig.

Examples: 192.168.5.77/24 2001:db8:75:fff::3/64. (Enter '+++' to abort).
&gt; 192.168.0.20/24

Enter your name server IP address.

You can enter more than one, separated by space, if necessary.
Leave empty if you don't need one.

Examples: 192.168.5.77 2001:db8:75:fff::3. (Enter '+++' to abort).
&gt; 192.168.0.1

Enter your search domains, separated by a space:. (Enter '+++' to abort).
&gt; example.com

Enter the IP address of your name server. Leave empty if you do not need one. (En
ter '+++' to abort).
&gt; 192.168.0.1</screen>
   </example>
   <para>
    Pour terminer, vous êtes invité à saisir des informations sur le serveur d'installation, telles que l'adresse IP, le répertoire contenant les données d'installation et les références de connexion. Dès que vous avez saisi toutes les données requises, le système d'installation est chargé.
   </para>
  </sect3>
 </sect2>

 <sect2 xml:id="sec.prep.connect">
  <title>Connexion au système d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase></title>
  <para>
   Après avoir chargé le système d'installation, linuxrc veut connaître le type d'affichage que vous comptez utiliser pour contrôler la procédure d'installation. Vous pouvez choisir parmi <literal>X11</literal> (système X Window), <literal>VNC</literal> (protocole Virtual Network Computing), <literal>SSH</literal> (mode texte ou installation X11 via un shell sécurisé) ou la <literal>console ASCII</literal>. Il est conseillé de sélectionner <literal>VNC</literal> ou <literal>SSH</literal>.
  </para>
  <para>
   Si vous optez pour la <literal>console ASCII</literal>, YaST démarre en mode texte et vous pouvez exécuter l'installation directement sur votre terminal. Pour plus d'informations sur l'utilisation de YaST en mode texte, reportez-vous au <xref linkend="cha.yast.text"/>. L'utilisation de la <literal>console ASCII</literal> ne s'avère utile qu'en cas d'installation dans une partition logique.
  </para>
  <note>
   <title>émulation de terminal pour la console ASCII</title>
   <para>
    Pour permettre le fonctionnement avec YaST en mode texte, il est nécessaire de procéder à l'exécution dans un terminal avec une émulation Linux/VT220 (également appelée <literal>console ASCII</literal>). Vous ne pouvez pas utiliser YaST sur un terminal 3270, par exemple.
   </para>
  </note>
  <sect3 xml:id="sec.inst.connect.vnc_inst">
   <title>Lancement de l'installation pour VNC</title>
   <procedure>
    <step>
     <para>
      Une fois que l'option d'installation <literal>VNC</literal> a été choisie, le serveur VNC démarre. Une brève information affichée dans la console fournit des informations sur l'adresse IP et le numéro d'affichage requis pour une connexion à l'aide de vncviewer.
     </para>
    </step>
    <step>
     <para>
      Démarrez une application client VNC sur votre système client.
     </para>
    </step>
    <step>
     <para>
      Saisissez l'adresse IP et le numéro d'affichage du système d'installation de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> lorsque vous y êtes invité.
     </para>
    </step>
    <step>
     <para>
      Une fois la connexion établie, commencez par installer <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> avec YaST.
     </para>
    </step>
   </procedure>
  </sect3>
  <sect3 xml:id="sec.inst.connect.x">
   <title>Lancement de l'installation pour le système X Window</title>
   <important>
    <title>mécanisme d'authentification X</title>
    <para>
     L'installation directe avec le système X Window repose sur un mécanisme d'authentification primitif basé sur des noms d'hôte. Ce mécanisme est désactivé dans les versions actuelles de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>. Il est préférable de procéder à une installation avec SSH ou VNC.
    </para>
   </important>
   <procedure>
    <step>
     <para>
      Assurez-vous que le serveur X permet au client (le système installé) de se connecter. Définissez la variable <command>DISPLAYMANAGER_XSERVER_TCP_PORT_6000_OPEN="yes"</command> dans le fichier <filename>/etc/sysconfig/displaymanager</filename>. Ensuite, redémarrez le serveur X et permettez la connexion du client au serveur à l'aide de <command>xhost &lt;client IP address&gt;</command>.
     </para>
    </step>
    <step>
     <para>
      À l'invite du système d'installation, saisissez l'adresse IP de la machine exécutant le serveur X.
     </para>
    </step>
    <step>
     <para>
      Patientez jusqu'à ce que YaST s'ouvre, puis démarrez l'installation.
     </para>
    </step>
   </procedure>
  </sect3>
  <sect3 xml:id="sec.inst.connect.ssh">
   <title>Lancement de l'installation pour SSH</title>
   <para>
    Pour se connecter à un système d'installation avec le nom <literal>earth</literal> en utilisant SSH, exécutez  <command>ssh -X earth</command>. Si votre poste de travail s'exécute sous Microsoft Windows, utilisez le client SSH et Telnet, ainsi que l'émulateur de terminal Putty, disponible sur le site <link xlink:href="http://www.chiark.greenend.org.uk/~sgtatham/putty/"/>. Définissez l'option <guimenu>Enable X11 forwarding </guimenu> (Activer le transfert X11) dans Putty sous <menuchoice> <guimenu>Connexion</guimenu> <guimenu>SSH</guimenu> <guimenu>X11</guimenu> </menuchoice>. Si vous utilisez un autre système d'exploitation, exécutez <command>ssh -X earth</command> pour vous connecter à un système d'installation avec le nom <systemitem>Earth</systemitem>. Le transfert X via SSH est pris en charge, pour autant que vous disposiez d'un serveur X local. Dans le cas contraire, YaST fournit une interface texte via ncurses.
   </para>
   <para>
    Une invite de connexion apparaît. Saisissez <literal>root</literal> et connectez-vous en saisissant votre mot de passe. Saisissez la commande <command>yast.ssh</command> pour démarrer YaST. YaST vous guide ensuite tout au long du processus d'installation.
   </para>
   <para>
    Passez à la description détaillée de la procédure d'installation disponible au <xref linkend="cha.inst"/>.
   </para>
  </sect3>
 </sect2>

 <sect2 xml:id="sec.prep.boot_procedure">
  <title>Procédure de démarrage de <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> sur IBM z Systems</title>
  <para>
   Le processus de démarrage de SLES 10 et 11 a suivi le schéma suivant. Pour plus d'informations, reportez-vous à la documentation fournie sur le site <link xlink:href="http://www.ibm.com/developerworks/linux/linux390/documentation_suse.html"/>.
  </para>
  <orderedlist>
   <listitem>
    <para>
     Indiquez le kernel.
    </para>
   </listitem>
   <listitem>
    <para>
     Indiquez ou créez un fichier initrd pour le kernel spécifié.
    </para>
   </listitem>
   <listitem>
    <para>
     Indiquez les chemins corrects du fichier initrd et du kernel dans le fichier <filename>/etc/zipl.conf</filename>.
    </para>
   </listitem>
   <listitem>
    <para>
     Installez la configuration fournie au système par <filename>/etc/zipl.conf</filename>.
    </para>
   </listitem>
  </orderedlist>
  <para>
   SLES 12 introduit un changement dans la façon dont <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> démarre sur IBM z Systems. Ce changement s'explique par plusieurs raisons :
  </para>
  <itemizedlist>
   <listitem>
    <para>
     Alignement sur d'autres architectures : d'un point de vue administratif, les systèmes SLES doivent se comporter de la même façon quelle que soit l'architecture.
    </para>
   </listitem>
   <listitem>
    <para>
     Btrfs : le chargeur d'amorçage zipl est techniquement incompatible avec Btrfs, le nouveau système de fichiers racine par défaut pour SLES (reportez-vous au <xref linkend="sec.filesystems.major.btrfs"/> pour plus de détails).
    </para>
   </listitem>
   <listitem>
    <para>
     Prise en charge des retours à l'état initial du système avec Snapper : utilisé conjointement avec Btrfs, Snapper fournit des instantanés du système démarrables qui peuvent être utilisés pour les retours à l'état initial du système (reportez-vous au <xref linkend="cha.snapper"/> pour plus de détails).
    </para>
   </listitem>
  </itemizedlist>
  <para>
   Pour ces raisons, à partir de SLES 12, GRUB 2 remplace la commande zipl sur IBM <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> pour z Systems. Sur l'architecture AMD64/Intel 64, GRUB 2 inclut des pilotes de périphérique au niveau du microprogramme pour accéder au système de fichiers. Le macroordinateur ne contient pas de microprogramme et l'ajout de <literal>ccw</literal> à GRUB 2 représenterait une tâche considérable, mais nécessiterait aussi la réimplémentation de zipl dans GRUB 2. Par conséquent, <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> utilise une approche en deux étapes :
  </para>
  <variablelist>
   <varlistentry>
    <term>Première étape :</term>
    <listitem>
     <para>
      Une partition distincte contenant le kernel et un fichier initrd est montée sur <filename>/boot/zipl</filename> (opération comparable à <filename>/boot/efi</filename> sur les plates-formes UEFI). Ce kernel et le fichier initrd sont chargés via la commande zipl et utilisent la configuration mentionnée dans le fichier <filename>/boot/zipl/config</filename>.
     </para>
     <para>
      Cette configuration ajoute le mot clé <literal>initgrub</literal> à la ligne de commande du kernel. Une fois que le kernel et le fichier initrd sont chargés, le fichier initrd active les périphériques requis pour monter le système de fichiers racine (voir le fichier <filename>/boot/zipl/active_devices.txt</filename>). Ensuite, un programme d'espace utilisateur GRUB 2 est lancé afin de lire le fichier <filename>/boot/grub2/grub.cfg</filename>.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Deuxième étape :</term>
    <listitem>
     <para>
      Le kernel et le fichier initrd dans le fichier <filename>/boot/grub2/grub.cfg</filename> sont démarrés à l'aide de la commande <command>kexec</command>. Tous les périphériques répertoriés dans le fichier <filename>/boot/zipl/active_devices.txt</filename> sont activés, le système de fichiers racine est monté et la procédure de démarrage se poursuit comme sur les autres architectures.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </sect2>
</sect1>
