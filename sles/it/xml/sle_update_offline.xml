<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="sle_update_offline.xml" version="5.0" xml:id="cha.update.offline">
 <title>Upgrade offline</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>sì</dm:translation>
  </dm:docmanager>
  <abstract>
   <para>
    In questo capito viene illustrato come eseguire l'upgrade di un'installazione SUSE Linux Enterprise esistente con YaST avviato da un supporto di installazione. Ad esempio, il programma di installazione di YaST può essere avviato da un DVD, in rete o dal disco rigido sul quale risiede il sistema.
   </para>
  </abstract>
 </info>
 <sect1 xml:id="sec.update.offline.conceptual-overview">
  <title>Panoramica concettuale</title>
  <para>
   Prima di eseguire l'upgrade del sistema, leggere la <xref linkend="sec.update.prep"/>.
  </para>
  <para>
   Per eseguire l'upgrade del sistema, effettuare l'avvio da un'origine di installazione, con la stessa procedura che si utilizzerebbe per una nuova installazione. Tuttavia quando viene visualizzata la schermata di avvio, è necessario selezionare <guimenu>Esegui l'upgrade</guimenu> (anziché <guimenu>Installazione</guimenu>). È possibile avviare l'upgrade da:
  </para>

  <itemizedlist>
   <listitem>
    <formalpara>
     <title>Supporti rimovibili</title>
     <para>
      Tra questi supporti sono inclusi CD, DVD o dispositivi di memorizzazione di massa USB. Per ulteriori informazioni, consultare la <xref linkend="sec.update.offline.dvd"/>.
     </para>
    </formalpara>
   </listitem>
   <listitem>
    <formalpara>
     <title>Risorsa di rete</title>
     <para>
      È possibile eseguire l'avvio dal supporto locale, quindi selezionare il rispettivo tipo di installazione di rete, oppure è possibile eseguire l'avvio via PXE. Per ulteriori informazioni, consultare la <xref linkend="sec.update.offline.network"/>.
     </para>
    </formalpara>
   </listitem>
  </itemizedlist>
 </sect1>


 <sect1 xml:id="sec.update.offline.dvd">
  <title>Avvio dell'upgrade da un supporto di installazione</title>
  <para>
   Di seguito è descritta la procedura di avvio da un DVD, ma è possibile utilizzare anche un altro supporto di installazione locale come un'immagine ISO in un dispositivo di memorizzazione di massa USB. Il supporto e il metodo di avvio da selezionare dipendono dall'architettura del sistema e dalla presenza del BIOS tradizionale o dello UEFI nel computer.
  </para>
  <procedure xml:id="pro.update.sle12.offline.dvd">
   <title>Upgrade manuale da SLE 11 SP4 a SLE 12 SP5</title>
   <step>
    <para>
     Selezionare e preparare un supporto di avvio, vedere <xref linkend="sec.i.yast2.startup"/>.
    </para>
   </step>
   <step>
    <para>
     Inserire il DVD 4 del supporto di installazione di SUSE Linux Enterprise 12 SP1 e avviare il computer. Viene visualizzata la schermata <guimenu>Benvenuti</guimenu>, seguita dalla schermata di avvio.
    </para>
   </step>
   <step>
    <para>
     Avviare il sistema selezionando <emphasis>Upgrade</emphasis> nel menu di avvio.
    </para>
   </step>
   <step>
    <para>
     Continuare con il processo di upgrade come descritto nella <xref linkend="sec.update.sle12.start.upgr.after.boot"/>.
    </para>
   </step>
  </procedure>
 </sect1>

 <sect1 xml:id="sec.update.offline.network">
  <title>Avvio dell'upgrade da un'origine di rete</title>
  <para>
   Per avviare un upgrade da un'origine di installazione di rete, verificare che siano soddisfatti i seguenti requisiti:
  </para>
  <variablelist>
   <title>Requisiti per l'upgrade da un'origine di installazione di rete</title>
   <varlistentry>
    <term>Origine di installazione di rete</term>
    <listitem>
     <para>
      L'impostazione dell'origine dell'installazione di rete è configurata in base al <xref linkend="cha.deployment.instserver"/>.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Connessione e servizi di rete</term>
    <listitem>
     <para>
      Sia il server di installazione sia il computer di destinazione devono essere dotati di una connessione di rete funzionante. I servizi di rete obbligatori sono:
     </para>
     <itemizedlist>
      <listitem><para>DNS (Domain Name Service)</para></listitem>
      <listitem><para>DHCP (necessario solo per l'avvio tramite PXE, l'IP può essere impostato manualmente durante la configurazione)</para></listitem>
      <listitem><para>OpenSLP (facoltativo)</para></listitem>
     </itemizedlist>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Supporto di avvio</term>
    <listitem>
     <para>
      Tenere a portata di mano un DVD 1 di <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> (o un'immagine ISO locale) per avviare il sistema di destinazione <emphasis>o</emphasis> un sistema di destinazione configurato per l'avvio via PXE in base alla <xref linkend="sec.deployment.prep_boot.pxeprep" xrefstyle="HeadingOnPage"/>. Per informazioni più approfondite sull'avvio dell'upgrade da un server remoto, fare riferimento al <xref linkend="cha.deployment.remoteinst"/>.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
  <sect2 xml:id="sec.update.sle.manual.network.boot-from-dvd">
   <title>Upgrade manuale tramite l'origine di installazione di rete - Avvio da DVD</title>
   <para>
    Questa procedura descrive l'esempio di avvio da un DVD, ma è possibile utilizzare anche un altro supporto di installazione locale come un'immagine ISO in un dispositivo di memorizzazione di massa USB. Il modo in cui si seleziona il metodo di avvio e si avvia il sistema dal supporto dipende dall'architettura di sistema e dalla presenza nel computer di un BIOS tradizionale o di uno UEFI. Per informazioni dettagliate, vedere i collegamenti di seguito.
   </para>
   <procedure xml:id="pro.update.sle.manual.network.boot-from-dvd">

    <step>
     <para>
      Inserire il DVD 4 del supporto di installazione di SUSE Linux Enterprise 12 SP1 e avviare il computer. Viene visualizzata la schermata <guimenu>Benvenuti</guimenu>, seguita dalla schermata di avvio.
     </para>
    </step>
    <step>
     <para>
      Selezionare il tipo di origine di installazione di rete che si desidera utilizzare (FTP, HTTP, NFS, SMB o SLP). Generalmente è possibile effettuare questa scelta premendo <keycap>F4</keycap> ma, se il computer è dotato di UEFI anziché di un BIOS tradizionale, potrebbe essere necessario modificare i parametri di avvio manualmente. Per informazioni dettagliate, vedere <xref linkend="sec.i.yast2.source.net"/> nel <xref linkend="cha.inst"/>.
     </para>
    </step>
    <step>
     <para>
      Continuare con il processo di upgrade come descritto nella <xref linkend="sec.update.sle12.start.upgr.after.boot"/>.
     </para>
    </step>
   </procedure>
  </sect2>
  <sect2 xml:id="sec.update.sle.manual.network.pxe-boot">
   <title>Upgrade manuale tramite l'origine di installazione di rete - Avvio tramite PXE</title>
   <para>
    Per effettuare un upgrade da un'origine di installazione di rete utilizzando Avvio PXE, procedere come descritto di seguito:
   </para>
   <procedure xml:id="pro.update.sle.manual.network.pxe-boot">
    <step>
     <para>
      Modificare la configurazione del server DHCP per fornire le informazioni sull'indirizzo necessarie per l'avvio via PXE. Per informazioni, vedere la <xref linkend="sec.deployment.prep_boot.pxeprep"/>.
     </para>
    </step>
    <step>
     <para>
      Impostare il server TFTP in modo che conservi l'immagine di avvio necessaria per l'avvio via PXE. Utilizzare il DVD 4 del supporto di installazione di SUSE Linux Enterprise 12 SP1 o seguire le istruzioni riportate nella <xref linkend="sec.deployment.prep_boot.tftp"/>.
     </para>
    </step>
    <step>
     <para>
      Preparare l'avvio PXE e Wake-on-LAN nel computer di destinazione.
     </para>
    </step>
    <step>
     <para>
      Iniziare l'avvio del sistema di destinazione e utilizzare VNC per la connessione remota alla routine di installazione in esecuzione sul computer. Per ulteriori informazioni, vedere la <xref linkend="sec.deployment.remoteinst.monitor.vnc"/>.
     </para>
    </step>
    <step>
     <para>
      Continuare con il processo di upgrade come descritto nella <xref linkend="sec.update.sle12.start.upgr.after.boot"/>.
     </para>
    </step>
   </procedure>
  </sect2>
 </sect1>

 <sect1 xml:id="sec.update.offline.automated">
  <title>Abilitazione dell'upgrade automatico</title>
  <para>
   È possibile eseguire automaticamente il processo di upgrade. Per abilitare l'aggiornamento automatico, è necessario impostare il parametro del kernel <literal>autoupgrade=1</literal>. È possibile impostare tale parametro all'avvio, nel campo <literal>Opzioni di avvio</literal>. Per informazioni, vedere <link xlink:href="https://www.suse.com/documentation/sles-12/book_autoyast/data/introduction.html"/>.
  </para>
 </sect1>
 <sect1 xml:id="sec.update.sle12.start.upgr.after.boot">
  <title>Upgrade di SUSE Linux Enterprise</title>
  <para>
   <remark>taroth 2014-11-13: argh, the following is terminology hell regarding
     the software strings: "upgrade"/"update" are used intermittently and
     without clear differentiation...</remark>
  </para>
  <para>
   Prima di eseguire l'upgrade del sistema, leggere la <xref linkend="sec.update.prep"/>. Per eseguire una migrazione automatica, procedere come indicato di seguito:
  </para>
  <procedure>
   <step>
    <para>
     Dopo avere avviato (da un supporto di installazione o dalla rete), selezionare la voce <guimenu>Upgrade</guimenu> nella schermata di avvio. Se si desidera eseguire l'upgrade manualmente, come indicato nella procedura seguente, è necessario disabilitare il processo di upgrade automatico. Vedere <xref linkend="sec.update.offline.automated"/>.
    </para>
    <warning>
     <title>una scelta sbagliata può comportare una perdita di dati</title>
     <para>
      Se si seleziona <guimenu>Installazione</guimenu> anziché <guimenu>Upgrade</guimenu>, successivamente i dati potrebbero andare persi. È necessario prestare molta attenzione a non distruggere le partizioni dei dati quando si esegue una nuova installazione.
     </para>
     <para>
      Selezionare <guimenu>Upgrade</guimenu> in questa fase.
     </para>
    </warning>
    <para>
     YaST avvia il sistema di installazione.
    </para>
   </step>
   <step>
    <para>
     Nella schermata <guimenu>Benvenuti</guimenu> scegliere <guimenu>Lingua</guimenu> e <guimenu>Tastiera</guimenu> e accettare il contratto di licenza. Fare clic su <guimenu>Avanti</guimenu> per continuare.
    </para>
    <para>
     YaST controlla le partizioni per i sistemi SUSE Linux Enterprise già installati.
    </para>
   </step>
   <step>
    <para>
     Nella schermata <guimenu>Seleziona per l'aggiornamento</guimenu> selezionare la partizione di cui eseguire l'upgrade e fare clic su <guimenu>Avanti</guimenu>.
    </para>
    <para>
     YaST monta la partizione selezionata e visualizza tutti gli archivi rilevati nella partizione di cui si desidera eseguire l'upgrade.
    </para>
   </step>
   <step>
    <para>
     Nella schermata <guimenu>Archivi utilizzati in precedenza</guimenu> modificare lo stato degli archivi: abilitare quelli da includere nel processo di upgrade e disabilitare quelli che non sono più necessari. Fare clic su <guimenu>Avanti</guimenu> per continuare.
    </para>
   </step>
   <step>
    <para>
     Nella schermata <guimenu>Registrazione</guimenu> specificare se si desidera registrare il sistema sottoposto ad upgrade ora immettendo i dati di registrazione e facendo clic su <guimenu>Avanti</guimenu> oppure scegliere <guimenu>Ignora registrazione</guimenu>. Per informazioni dettagliate sulla registrazione del sistema, vedere la <xref linkend="sec.update.registersystem"/>.
    </para>
   </step>
   <step>
    <para>
     Rivedere le <guimenu>Impostazioni dell'installazione</guimenu> per l'upgrade prestando particolare attenzione alle <guimenu>Opzioni di aggiornamento</guimenu>. Scegliere una delle seguenti opzioni:
    </para>
    <itemizedlist>
     <listitem>
      <para>
       <guimenu>Aggiorna solo pacchetti installati</guimenu>. In questo caso si rischia di perdere le nuove funzioni fornite con la versione più recente di SUSE Linux Enterprise.
      </para>
     </listitem>
     <listitem>
      <para>
       <guimenu>Aggiornamento con installazione di nuovo software e nuove funzioni</guimenu>. Fare clic su <guimenu>Seleziona modelli</guimenu> per abilitare o disabilitare modelli e pacchetti in base alle esigenze specifiche.
      </para>
     </listitem>
    </itemizedlist>

    <note>
     <title>scelta del desktop</title>
     <para>
      Se prima dell'upgrade a SUSE Linux Enterprise 12 è stato utilizzato KDE (<varname>DEFAULT_WM</varname> in <filename>/etc/sysconfig/windowmanager</filename> era impostato su <literal>kde*</literal>), l'ambiente desktop verrà sostituito automaticamente da GNOME dopo l'upgrade. Per default, il display manager KDM verrà sostituito da GDM.
     </para>
     <para>
      Per cambiare la scelta dell'ambiente desktop o il gestore delle finestre, modificare la selezione software facendo clic su <guimenu>Seleziona modelli</guimenu>.
     </para>
    </note>
   </step>
   <step>
    <para>
     Se le impostazioni sono quelle desiderate, avviare la procedura di installazione e rimozione facendo clic su <guimenu>Aggiorna</guimenu>.
    </para>
   </step>
   <step>
    <para>
     Terminato il processo di upgrade verificare la presenza di eventuali <quote>pacchetti orfani</quote>. I pacchetti orfani sono pacchetti che non appartengono più ad alcun archivio attivo. Per visualizzarli, è possibile utilizzare il comando seguente:
    </para>
<screen>zypper packages --orphaned</screen>
    <para>
     Tale elenco consente di stabilire se un determinato pacchetto è ancora necessario o se può essere disinstallato senza problemi.
    </para>
   </step>
  </procedure>
 </sect1>
 <sect1 xml:id="sec.update.sle.manager">
  <title>Aggiornamento tramite SUSE Manager</title>

  <para>
   SUSE Manager è una soluzione server che fornisce aggiornamenti, patch e correzioni per la sicurezza dei client SUSE Linux Enterprise. Viene fornito in dotazione con un set di strumenti e un'interfaccia utente basata su Web per i task di gestione. Per ulteriori informazioni su SUSE Manager, vedere <link xlink:href="https://www.suse.com/products/suse-manager/"/>.
  </para>

  <para>
   SUSE Manager fornisce il supporto necessario per eseguire la migrazione di un Service Pack o l'upgrade di un intero sistema.
  </para>

  <variablelist>

   <varlistentry>
    <term>Migrazione SP</term>
    <listitem>
     <para>
      La migrazione SP consente di eseguire la migrazione da un Service Pack (SP) a un altro all'interno di una versione principale (ad esempio, da SLES 12 SP1 a 12 SP2). Per ulteriori informazioni, vedere <citetitle>SUSE Manager Best Practices</citetitle>, capitolo <quote>Client Migration</quote> (in lingua inglese):
     </para>
     <para>
       <link xlink:href="https://www.suse.com/documentation/suse-manager/"/>, versione 3.1.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Upgrade del sistema</term>
    <listitem>
     <para>
      Con SUSE Manager è possibile eseguire un upgrade del sistema. Grazie alla tecnologia AutoYaST integrata, è possibile eseguire gli upgrade da una versione principale a quella successiva (ad esempio, da SLES 11 SP3 a 12 SP2). Per ulteriori informazioni, vedere <citetitle>SUSE Manager Best Practices</citetitle>, capitolo <quote>Client Migration</quote> (in lingua inglese)
     </para>
     <para>
      <link xlink:href="https://www.suse.com/documentation/suse-manager/"/>, versione 3.1.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
<para>
  <remark>taroth 2018-09-26: the SUMA docs do not cover migration to
   SLE 12 SP4 yet, therefore removed the specific section title from
   the pointers above and filed https://bugzilla.suse.com/show_bug.cgi?id=1109790
 </remark>
</para>
 </sect1>
 <sect1 xml:id="sec.update.reg.status.after.rollback">
  <title>Aggiornamento dello stato della registrazione dopo il rollback</title>

  <para>
   Quando si esegue l'upgrade di un Service Pack, è necessario modificare la configurazione nel server di registrazione per consentire l'accesso ai nuovi archivi. Se il processo di upgrade viene interrotto o annullato (tramite il ripristino da un backup o da uno snapshot), le informazioni sul server di registrazione sono incoerenti con lo stato del sistema. Questo potrebbe impedire l'accesso agli archivi di aggiornamenti o comportare l'uso di archivi scorretti nel client.
  </para>

  <para>
   Quando si esegue un rollback tramite Snapper, il sistema invia una notifica al server di registrazione per garantire che durante il processo di avvio venga configurato l'accesso agli archivi corretti. Se il sistema era stato ripristinato con qualsiasi altro metodo, oppure la comunicazione con il server di registrazione non è riuscita per qualsiasi motivo (ad esempio perché il server non era accessibile per problemi di rete), attivare manualmente il rollback nel client chiamando:
  </para>

<screen><command>snapper</command> rollback</screen>

  <para>
   È consigliabile verificare sempre che nel sistema siano configurati gli archivi corretti, soprattutto dopo un aggiornamento del servizio tramite:
  </para>

<screen><command>zypper</command> ref -s</screen>

  <para>
   Questa funzionalità è disponibile nel pacchetto
   <package>rollback-helper</package>
   .
  </para>
 </sect1>
 <sect1 xml:id="sec.update.registersystem">


  <title>Registrazione del sistema</title>

  <para>
   Se durante l'installazione è stato ignorato il passaggio di registrazione, è possibile registrare il sistema in qualsiasi momento utilizzando il modulo <guimenu>Registrazione prodotto</guimenu> in YaST.
  </para>

  <para>
   La registrazione dei sistemi comporta i seguenti vantaggi:
  </para>

  <itemizedlist>
   <listitem>
    <para>
     Idoneità per ottenere supporto
    </para>
   </listitem>
   <listitem>
    <para>
     Disponibilità degli aggiornamenti di sicurezza e delle correzioni dei bug
    </para>
   </listitem>
   <listitem>
    <para>
     Accesso al SUSE Customer Center
    </para>
   </listitem>
  </itemizedlist>

  <procedure>
   <step>
    <para>
     Avviare YaST e selezionare <menuchoice> <guimenu>Software</guimenu>
     <guimenu>Registrazione prodotto</guimenu> </menuchoice>  per aprire la finestra di dialogo <guimenu>Registrazione</guimenu>.
    </para>
   </step>
   <step>
    <para>
     Specificare l'indirizzo <guimenu>E-mail</guimenu> associato all'account SUSE in uso o utilizzato dalla propria organizzazione per gestire le sottoscrizioni. Se non si dispone ancora di un account SUSE, andare alla home page del SUSE Customer Center (<link xlink:show="new" xlink:href="https://scc.suse.com/"/>) per crearne uno.
    </para>
   </step>
   <step>
    <para>
     Immettere il <guimenu>Codice di registrazione</guimenu> ricevuto con la copia di <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>.
    </para>
   </step>
   <step xml:id="step.y2.register.final">
    <para>
     Per avviare la registrazione, procedere con <guimenu>Avanti</guimenu>. Se nella rete sono disponibili uno o più server di registrazione locali, è possibile sceglierne uno da un elenco. In alternativa, per ignorare i server di registrazione locali ed eseguire la registrazione con il server di registrazione SUSE di default, scegliere <guimenu>Annulla</guimenu>.
    </para>
    <para>
     Durante la registrazione gli archivi di aggiornamenti online vengono aggiunti all'installazione dell'upgrade. Al termine, è possibile scegliere se installare le ultime versioni dei pacchetti disponibili dagli archivi di aggiornamenti. In questo modo si ottiene un percorso di upgrade pulito per tutti i pacchetti e si ha la certezza che a <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> verranno applicati gli ultimi aggiornamenti di sicurezza disponibili. Se si sceglie <guimenu>No</guimenu>, tutti i pacchetti vengono installati dai supporti di installazione. Fare clic su <guimenu>Avanti</guimenu> per continuare.
    </para>
    <para>
     Al termine della registrazione, YaST mostra un elenco di estensioni, componenti aggiuntivi e moduli disponibili per il sistema. Per selezionarli e installarli, passare alla <xref linkend="sec.add-ons.installation"/>.
    </para>
   </step>
  </procedure>
 </sect1>

</chapter>
